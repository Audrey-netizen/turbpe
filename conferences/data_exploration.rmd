Working directory info: IMPORTANT NOTE, keep this directory listing identical
to minimize wd errors between devices working on the same repository
  Yes that means please create a folder called "repos"
```{r}
setwd("~/Documents/repos/turbpe")
```

Packages list, plus Audrey's versions of each package
  I didn't make it mandatory to download a specific version of each package as I
  don't want anyone to make redundant downloads, just commented what I'm using
  FYI Andrew we should pretty much always be using the same versions of packages
  since we're both on macbook M4 silicone chips, so this should never be
  something to worry about for you
```{r}
library(dplyr) #V1.1.4
library(ggplot2) #V4.0.0
library(lavaan) #V0.6-20
library(piecewiseSEM) #V2.3.1
library(readr) #V2.1.5
#apparently this is faster than read.csv? Will try it, hopefully nothing breaks
library(scales) #V1.4.0
library(tidyverse) #V2.0.0
library(vegan) #V2.7-1

```

Loading up the csv files + assigning them variables
```{r}
abiotics <- read_csv("~/Documents/repos/turbpe/spreadsheets/abiotics.csv")
flowers <- read_csv("~/Documents/repos/turbpe/spreadsheets/flowers.csv")
plant_IDs <- read_csv("~/Documents/repos/turbpe/spreadsheets/Plant_ID_list.csv")
soil_data <- read_csv("~/Documents/repos/turbpe/spreadsheets/soil.csv")
road_widths <- read_csv("~/Documents/repos/turbpe/spreadsheets/road_widths.csv")

#for bee captures we need to further filter it to only include the 8 replicates
#being used for conference presentations (thanks Andrew :3)
bee_captures_8th <- read_csv("~/Documents/repos/turbpe/spreadsheets/bee_captures.csv") %>%
  filter(Replicate >= 1 & Replicate <= 8)
```

Just for my own viewing purposes here, makes rest easier
```{r}
names(bee_captures_8th)
names(abiotics)
names(flowers)
names(plant_IDs)
names(road_widths)
```

What the heck is a glipmse
```{r}
glimpse(abiotics)
glimpse(flowers)
glimpse(plant_IDs)
glimpse(road_widths)
# No really, I tried using this function now, it's giving nothing. I would
# rather just directly look at the csv files...
```

Basic summaries of bees we caught, starting with family
```{r}
family_summary <- bee_captures_8th %>%
  count(Family, name = "Count") %>%
  arrange(desc(Count))

print(family_summary)

genus_summary <- bee_captures_8th %>%
  count(Genus, name = "Count") %>%
  arrange(desc(Count))

print(genus_summary)

# No surprises, this upcoming one is gonna be very skewed to a certain species,
# since we know exactly what species it is as soon as we see an Apis... and we
# see a lot of Apis. Functionally useless bit of code rn but it's fun
species_summary <- bee_captures_8th %>%
  count(Species, name = "Count") %>%
  arrange(desc(Count))

print(species_summary)
```

Figure for this summary, will stick with just genus for now
```{r}

# This bit is redundant but I think it helps with clarity!
genus_summary <- bee_captures_8th %>%
  count(Genus, name = "Count") %>%
  arrange(desc(Count))

# Bar plot
# theme_minimal wow so cool, why doesn't everyone use this?
    # UI designers ranting about people being upset at them simplifying
    # in a nutshell hehe
ggplot(genus_summary, aes(x = reorder(Genus, -Count), y = Count, fill = Genus)) +
  geom_bar(stat = "identity") +
  scale_fill_viridis_d() +  # Colourblind-friendly <3
  labs(
    title = "Bee Genera Captured",
    x = "Genus",
    y = "Number of Captures"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
    axis.text.y = element_text(size = 10),
    axis.title = element_text(size = 12, face = "bold"),
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    legend.position = "none",  # Legend would be bloat
    plot.margin = margin(1, 1, 1, 1.5, "cm"),  # Slight margins change
    panel.grid.major.x = element_blank()  # No grids plz
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))
```

Repeat this but across four months
```{r}
# This is the important part, actually sorts out the month categories I desire
# for visibility purposes
months <- c("05", "06", "07", "08")
month_names <- c("May", "June", "July", "August")

# Ok this is an important part too... this for loop simultaneously is what sorts
# through the above months sections made and also makes it so all four figures
# are output in quick succession without copy pasting this four times :)
for (i in 1:length(months)) {
  month_data <- bee_captures_8th %>%
    filter(str_detect(Date, paste0("-", months[i], "-"))) %>%
    count(Genus, name = "Count") %>%
    arrange(desc(Count))
  
  p <- ggplot(month_data, aes(x = reorder(Genus, -Count), y = Count, fill = Genus)) +
    geom_bar(stat = "identity") +
    scale_fill_viridis_d() +
    labs(
      title = paste("Bee Genera Captured -", month_names[i]),
      x = "Genus",
      y = "Number of Captures"
    ) +
    theme_minimal() +
    theme(
      axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
      axis.text.y = element_text(size = 10),
      axis.title = element_text(size = 12, face = "bold"),
      plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
      legend.position = "none",
      plot.margin = margin(1, 1, 1, 1.5, "cm"),
      panel.grid.major.x = element_blank()
    ) +
    scale_y_continuous(expand = expansion(mult = c(0, 0.1)))
  
  print(p)
}
# Now that we're using a for loop we actually are assigning this production of
# the plot a variable
```

Baseline for organizing plant data
```{r}

flowers <- read_csv("~/Documents/repos/turbpe/spreadsheets/flowers.csv")
# I believe this is functionally useless, so may be removed later, but for now I
# want to keep up the priority of any given column titles being from the flowers
# spreadsheet... at the moment there is a lot of identitical titling
```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

